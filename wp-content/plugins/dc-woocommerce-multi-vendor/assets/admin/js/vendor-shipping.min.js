!function(t,i,e,s){t(function(){var e=e||{build:function(){this.init(),this.bindEvents()},init:function(){this.table_shipping_zone_settings=".wcmp-shipping-zone-settings",this.table_shipping_zone_methods=".wcmp-shipping-zone-methods",this.modify_shipping_methods=".modify-shipping-methods",this.modal_add_shipping_method=".wcmp-modal-add-shipping-method-modal",this.show_shipping_methods=this.table_shipping_zone_settings+" .wcmp-shipping-zone-show-method",this.add_shipping_methods=this.modal_add_shipping_method+" .wcmp-shipping-zone-add-method",this.edit_shipping_methods=this.table_shipping_zone_settings+" .edit-shipping-method",this.delete_shipping_method=this.table_shipping_zone_settings+" .delete-shipping-method",this.method_status=this.table_shipping_zone_methods+" .method-status",this.limit_zone_location=this.table_shipping_zone_settings+" #limit_zone_location"},bindEvents:function(){t(document.body).on("click",this.show_shipping_methods,this.showShippingMethods),t(document.body).on("wc_backbone_modal_response",this.addShippingMethod),t(document.body).on("wc_backbone_modal_response",this.updateShippingMethod),t(document.body).on("click",this.edit_shipping_methods,this.editShippingMethod),t(document.body).on("click",this.delete_shipping_method,this.deleteShippingMethod),t(document.body).on("change",this.method_status,this.toggleShippingMethod),t(document.body).on("change",this.limit_zone_location,this.limitZoneLocation),this.limitZoneLocation()},showShippingMethods:function(i){i.preventDefault();var e=t("#zone_id").val();t(this).WCBackboneModal({template:"wcmp-modal-add-shipping-method",variable:{zone_id:e}}),t(".wc-shipping-zone-method-selector select").change()},addShippingMethod:function(i,e,n){if("wcmp-modal-add-shipping-method"===e){i.preventDefault();var o=n.zone_id,d=n.wcmp_shipping_method;if(""==o);else if(""==d);else{var a={action:"wcmp-add-shipping-method",zoneID:o,method:d};t(this.add_shipping_methods).block({message:null,overlayCSS:{background:"#fff",opacity:.6}});t.ajax({method:"post",url:s,data:a,success:function(t){t.success&&location.reload()}})}}},editShippingMethod:function(i){i.preventDefault();var e=t(i.currentTarget).data("instance_id"),n=t(i.currentTarget).data("method_id"),o={action:"wcmp-configure-shipping-method",zoneId:t(i.currentTarget).data("zone_id"),instanceId:e,methodId:n};t("#method_id_selected").val(n),t("#instance_id_selected").val(e);t.ajax({method:"post",url:s,data:o,success:function(i){i&&t(this).WCBackboneModal({template:"wcmp-modal-update-shipping-method",variable:{methodId:n,instanceId:e,config_settings:i}})}})},updateShippingMethod:function(i,e,n){if("wcmp-modal-update-shipping-method"===e){i.preventDefault();var o=n.method_id,d=n.instance_id,a=n.zone_id,h={action:"wcmp-update-shipping-method",zoneID:a,posted_data:n,args:{instance_id:d,zone_id:a,method_id:o,settings:{}}};"free_shipping"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=0,h.args.settings.tax_status="none",h.args.settings.min_amount=n.minimum_order_amount),"local_pickup"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=n.method_cost,h.args.settings.tax_status=n.method_tax_status),"flat_rate"==o&&(h.args.settings.title=n.method_title,h.args.settings.description=n.method_description,h.args.settings.cost=n.method_cost,h.args.settings.tax_status=n.method_tax_status,h.args.settings["class_cost_"+n.shipping_class_id]=n.shipping_class_cost,h.args.settings.calculation_type=n.calculation_type);t.ajax({method:"post",url:s,data:h,success:function(t){t.success?location.reload():alert(resp.data)}})}},deleteShippingMethod:function(e){e.preventDefault();if(confirm(i.i18n.deleteShippingMethodConfirmation)){var n=t(e.target).is(this.delete_shipping_method)?e.target:t(e.target).closest(this.delete_shipping_method),o=t(n).parents(".edit_del_actions").attr("data-instance_id"),d=t("#zone_id").val(),a=a={action:"wcmp-delete-shipping-method",zoneID:d,instance_id:o};if(""==d);else if(""==o);else t.ajax({method:"post",url:s,data:a,success:function(t){t.success?location.reload():alert(resp.data)}})}},limitZoneLocation:function(i){t("#limit_zone_location").is(":checked")?t(".hide_if_zone_not_limited").show():t(".hide_if_zone_not_limited").hide()},toggleShippingMethod:function(i){i.preventDefault();var e=t(i.target).is(":checked"),s=t(i.target).val(),n=t("#zone_id").val(),o={action:"wcmp-toggle-shipping-method",zoneID:n,instance_id:s,checked:e};if(""==n);else if(""==s);else{t(".wcmp-container").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});t.ajax({method:"post",url:wcmp_vendor_shipping_script_data.ajaxurl,data:o,success:function(i){i.success?t(".wcmp-container").unblock():(t(".wcmp-container").unblock(),alert(i.data))}})}}};t(e.build.bind(e))})}(jQuery,wcmp_vendor_shipping_script_data,wp,ajaxurl);